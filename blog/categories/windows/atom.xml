<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Windows | Mike Murray]]></title>
  <link href="http://mkmurray.com/blog/categories/windows/atom.xml" rel="self"/>
  <link href="http://mkmurray.com/"/>
  <updated>2012-12-15T15:41:41-07:00</updated>
  <id>http://mkmurray.com/</id>
  <author>
    <name><![CDATA[Mike Murray]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Custom Setup Bootstrappers]]></title>
    <link href="http://mkmurray.com/blog/2009/11/11/custom-setup-bootstrappers/"/>
    <updated>2009-11-11T15:03:00-07:00</updated>
    <id>http://mkmurray.com/blog/2009/11/11/custom-setup-bootstrappers</id>
    <content type="html"><![CDATA[<div class='post'>
<p>At work, we have a line of desktop products for one of clients installed on the user’s Windows machine via MSI installers.&#160; We use Visual Studio Setup Projects to create the MSI installers.&#160; Visual Studio also provides the ability to create setup bootstrappers to make sure the user has all the prerequisites needed for the MSI install technology and any dependencies required by your desktop product.&#160; These bootstrappers are unmanaged code, because you can’t always depend on the .NET framework already being there (at least not until everyone is off of XP and lower).&#160; I have developed a solution that has worked for the last year or more, but has felt clumsy and slapped together.&#160; Recently I found the <a href="http://dotnetinstaller.codeplex.com/">open source project called dotNetInstaller</a> which has better provided me with the control and flexibility I need for custom logic during bootstrap and install time.&#160; I’ll first introduce you to my “hack” solution.</p> <span class="fullpost">   <p>It has been difficult for me to find ways to tie into the bootstrapper logic workflow to add in custom logic during installs, and Visual Studio is very rigid in its flexibility and basic in its configuration options in this regard.&#160; Until recently, I had settled on writing managed, C# code for this custom logic meant to run before or after the MSI installer, and then creating another unmanaged <font face="Courier New">setup.exe</font> bootstrapper to ensure the .NET framework was installed just so that executable could run.&#160; So the user would run this new unmanaged <font face="Courier New">setup.exe</font> bootstrapper (making sure .NET framework was installed), which would then call my managed custom logic executable, which would then call the MSI installer’s unmanaged, Visual Studio-generated <font face="Courier New">setup.exe</font> bootstrapper (ensuring more prerequisites were installed), which would then finally install the MSI, and which would then lastly return to my managed custom logic executable for any post-install, clean up logic.&#160; I describe this solution in full (and how to generate the same bootstrappers that Visual Studio creates using MSBuild outside the IDE) in a StackOverflow.com answer that I submitted:</p>    <p><a title="http://stackoverflow.com/questions/1106768/how-can-i-reverse-engineer-an-installer-that-was-written-with-ghost-installer/1121846#1121846" href="http://stackoverflow.com/questions/1106768/how-can-i-reverse-engineer-an-installer-that-was-written-with-ghost-installer/1121846#1121846">http://stackoverflow.com/questions/1106768/how-can-i-reverse-engineer-an-installer-that-was-written-with-ghost-installer/1121846#1121846</a></p>    <p>Well, recently I found the <a href="http://dotnetinstaller.codeplex.com/">dotNetInstaller project on CodePlex.com</a> and have found it to be the control and flexibility I need for custom logic when bootstrapping installers.&#160; Not only does it give you great control over prerequisite install order, it also gives you the ability to run code after MSI install and to also filter on CPU architecture types, OS versions, and other registry or file system conditions.&#160; I have currently setup branching scenarios for the prerequisites based on if the user has a 32-bit (x86) or 64-bit (x64) OS.&#160; This utility will even let you brand the bootstrapper with a banner and icon, which is a change of pace from the plain and unlabeled bootstrapper that Visual Studio and MSBuild produce.</p>    <p>If you have custom bootstrapping needs, I have to highly recommend you give dotNetInstaller a look.&#160; Hopefully it will prove as flexible and powerful for your needs as it has for mine.</p> </span>  </div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Web Deployment Tool]]></title>
    <link href="http://mkmurray.com/blog/2009/09/29/web-deployment-tool/"/>
    <updated>2009-09-29T17:45:00-06:00</updated>
    <id>http://mkmurray.com/blog/2009/09/29/web-deployment-tool</id>
    <content type="html"><![CDATA[<div class='post'>
<p>It appears that the IIS team at Microsoft has officially completed a 1.0 version of the deployment utility I mentioned at the end of <a title="Visual Studio Web Deployment Projects" href="http://murrayon.net/2008/02/visual-studio-web-deployment-projects.html">my previous post about Visual Studio Web Deployment Projects</a> almost two years ago.&#160; It includes a command-line tool named MSDeploy that helps with deploying and syncing web projects across all of the web servers in your server farm.&#160; The installation also includes all kinds of packaging and deployment features that seem really handy.&#160; You can even do migrations from IIS 6 to IIS 7 or package your apps to be distributed via the <a href="http://www.microsoft.com/web/downloads/platform.aspx">Microsoft Web Platform Installer</a>.</p>  <p>I thought that maybe the tool creates MSI installers, but it appears the package may actually just be a ZIP file that you can import and export through the IIS Manager or various other command-line tools or PowerShell Cmdlets.</p>  <p>Here is the page where you can read more about the toolset and download the installer:&#160; <a title="http://www.iis.net/extensions/WebDeploymentTool" href="http://www.iis.net/extensions/WebDeploymentTool">http://www.iis.net/extensions/WebDeploymentTool</a></p>  </div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PowerShell 1.0 for Windows XP]]></title>
    <link href="http://mkmurray.com/blog/2009/03/24/powershell-1-0-for-windows-xp/"/>
    <updated>2009-03-24T14:08:00-06:00</updated>
    <id>http://mkmurray.com/blog/2009/03/24/powershell-1-0-for-windows-xp</id>
    <content type="html"><![CDATA[<div class='post'>
<p>I just noticed in today's Tuesday round of Microsoft Updates that there is an optional software download for PowerShell 1.0 on Windows XP.&#160; PowerShell has been one of those things that I really want to learn, but just haven't devoted the time.&#160; I desperately would like to replace my use of the Command Prompt with Windows PowerShell.</p>  <p>PowerShell really is more than just your regular <a href="http://en.wikipedia.org/wiki/Command_line_interpreter">Command Line Interpreter</a> that you have been used to, especially compared to the <a href="http://en.wikipedia.org/wiki/Command_Prompt_(Windows)">Windows Command Prompt</a>.&#160; You get the power of the command line shells that you may have tried out in Linux environments, but it really does go beyond those as well.&#160; PowerShell is (from Wikipedia) <font face="Courier New">&quot;Microsoft's new extensible command line shell and task-based scripting technology.&quot;</font>&#160; Here is a quote from an MSDN document that better explains the advantages PowerShell brings:</p> <span class='fullpost'> <blockquote>   <p>&quot;Unlike most shells, which accept and return text, Windows PowerShell is built on top of the .NET common language runtime (CLR) and the .NET Framework, and accepts and returns .NET objects. This fundamental change in the environment brings entirely new tools and methods to the management and configuration of Windows.</p>   <p>&quot;Windows PowerShell introduces the concept of a cmdlet (pronounced &quot;command-let&quot;), a simple, single-function command-line tool built into the shell. You can use each cmdlet separately, but their power is realized when you use these simple tools in combination to perform complex tasks. Windows PowerShell includes more than one hundred basic core cmdlets, and you can write your own cmdlets and share them with other users.</p>   <p>&quot;Like many shells, Windows PowerShell gives you access to the file system on the computer. In addition, Windows PowerShell providers enable you to access other data stores, such as the registry and the digital signature certificate stores, as easily as you access the file system.&quot;</p> </blockquote>  <p>If you want to know more about PowerShell, I would suggest the following readings:</p>  <ul>   <li><a href="http://en.wikipedia.org/wiki/Windows_PowerShell">Wikipedia - Windows PowerShell</a></li>    <li><a href="http://msdn.microsoft.com/en-us/library/aa973757(VS.85).aspx">MSDN - Windows PowerShell Getting Started Guide</a></li> </ul>  <p>Also, <a href="http://codebetter.com/members/james.kovacs.aspx">James Kovacs</a> from <a href="http://codebetter.com/">CodeBetter.com</a> has been doing <a href="http://codebetter.com/blogs/james.kovacs/archive/tags/PowerShell/default.aspx">a series of posts on the basics of PowerShell</a> that is a great light introduction to how a developer would find the tool most useful.&#160; Here are two of the starting posts from that series:</p>  <ul>   <li><a href="http://codebetter.com/blogs/james.kovacs/archive/2009/02/01/getting-started-with-powershell-developer-edition.aspx">Getting Started with PowerShell - Developer Edition</a></li>    <li><a href="http://codebetter.com/blogs/james.kovacs/archive/2009/02/07/powershell-processes-and-piping.aspx">PowerShell, Processes, and Piping</a></li> </ul> </span>  </div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[IIS 7 and ASP.NET Providers (Membership, Roles, and Profile)]]></title>
    <link href="http://mkmurray.com/blog/2009/02/17/iis-7-and-asp-net-providers-membership-roles-and-profile/"/>
    <updated>2009-02-17T17:38:00-07:00</updated>
    <id>http://mkmurray.com/blog/2009/02/17/iis-7-and-asp-net-providers-membership-roles-and-profile</id>
    <content type="html"><![CDATA[<div class='post'>
<p>I talked at length about the ASP.NET <a href="http://en.wikipedia.org/wiki/Provider_model">Provider Model pattern</a> and the ease of implementing several built-in services you can have for free with ASP.NET 2.0 in <a title="ASP.NET Providers - Membership, Role, and Profile" href="http://murrayon.net/2009/01/aspnet-providers-membership-role-and.html">my previous series of posts</a>.&#160; In this post, I will be discussing the advantages of using the ASP.NET Provider system under IIS 7 found in Windows Vista and Server 2008.&#160; I will also talk about an issue with using this Provider system to try and add authentication to an ASP.NET website that contains non-ASP.NET content, like static HTML pages.&#160; I think I'll start with the discussion about non-ASP.NET content first.</p> <span class='fullpost'> <h3>IIS 7.0 Integrated Pipeline</h3>  <p>Since I don't really understand much about <a title="Internet Server Application Programming Interface" href="http://en.wikipedia.org/wiki/ISAPI">ISAPI</a> filters and such, I'm just going to quote stuff from random pages on the <a href="http://www.iis.net/">official Microsoft IIS site</a>:</p>  <blockquote>   <p>&quot;IIS 6.0 and previous versions allowed the development of .NET application components via the ASP.NET platform. ASP.NET integrated with IIS via an ISAPI extension, and exposed its own application and request processing model. This effectively exposed two separate server pipelines, one for native ISAPI filters and extension components, and another for managed application components. ASP.NET components would execute entirely inside the ASP.NET ISAPI extension bubble and only for requests mapped to ASP.NET in the IIS script map configuration.</p>    <p>&quot;IIS 7.0 integrates the ASP.NET runtime with the core web server, providing a unified request processing pipeline that is exposed to both native and managed components known as modules.&quot;</p> </blockquote>  <p>and...</p>  <blockquote>   <p>&quot;This allows developers to fully extend the IIS 7.0 server with the richness of ASP.NET 2.0 and the .NET Framework, instead of using the lower level IIS C++ APIs. Existing ASP.NET applications also immediately benefit from tighter integration using existing ASP.NET features like Forms Authentication, Roles, and Output Caching for all content.&quot;</p> </blockquote>  <p>Note the last three words there:&#160; &quot;<font face="Courier New">for all content.</font>&quot;&#160; When I started this endeavor to implement the ASP.NET Provider system, I didn't realize that it would really only apply to ASP.NET content and pages.&#160; I didn't realize on IIS 6 I would have to fiddle with ISAPI filters and content filters to make my implementation work.&#160; And when I tried to doing a mapping (like <font face="Courier New">*.html</font> to the ASP.NET ISAPI DLL), I either didn't do it right or it just isn't very reliable and stable; here is a link to <a title="IIS problems with forms authentication &amp; HTML pages" href="http://forums.asp.net/t/1184547.aspx">the thread I followed in trying to make the appropriate changes in IIS 6</a>.&#160; I will note however that <a href="http://www.ultidev.com/products/Cassini/index.htm">UltiDev's Cassini Web Server</a> can host such a site with absolutely no extra modification, where even IIS 7 required a little configuration.</p>  <p>By default in IIS 7, an <a title="IIS and ASP.NET: The Application Pool" href="http://www.developer.com/net/asp/article.php/2245511">application pool</a> runs using the <font face="Courier ne">Integrated</font> mode for the <font face="Courier New">Managed Pipeline</font> configuration.&#160; But there is also the option of <font face="Courier New">Classic</font> mode, which is helpful if you are needing strict compatibility with how you ran a website under IIS 6.&#160; In many cases, however, an existing ASP.NET website runs under <font face="Courier New">Integrated</font> mode without any problems.</p>  <h3>Configuring an ASP.NET Website to Run on IIS 7</h3>  <p>First, I think I will point you to a great video and document on Microsoft's official IIS site that explains everything you really need to know.&#160; Then I will emphasize a few of the important points and also a gotcha or two.&#160; Here are the links you should reference:</p>  <ul>   <li><a href="http://learn.iis.net/page.aspx/377/using-aspnet-forms-authentication/">Using ASP.NET Forms Authentication</a> (video) </li>    <li><a href="http://learn.iis.net/page.aspx/243/aspnet-integration-with-iis7/">ASP.NET Integration with IIS 7.0</a> </li> </ul>  <p>The video above is also a terrific introduction to IIS 7.&#160; Below is a screenshot of IIS's UI for configuring a website:</p>  <p><a href="http://lh6.ggpht.com/_rps657FzHZ0/SZtZDNleinI/AAAAAAAAACw/b2kq_6XIGD8/s1600-h/IIS_screenshot%5B5%5D.png"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="IIS_screenshot" src="http://lh5.ggpht.com/_rps657FzHZ0/SZtZDjlrIRI/AAAAAAAAAC0/cC29GwiAIhk/IIS_screenshot_thumb%5B3%5D.png?imgmax=800" width="475" height="368" /></a> </p>  <p>Notice the <font face="Courier New">ASP.NET</font> section and how it's able to use your Providers to bring back Users, Roles, and Profile data back from the database.&#160; This UI reads from and writes to your <font face="Courier New">Web.config</font> and is really slick in my opinion.</p>  <p>The only real &quot;breaking change&quot; for running your website under IIS 7 is the fact that your <font face="Courier New">Web.config</font> might need a little migration to be compatible with <font face="Courier New">Integrated</font> mode.&#160; Apparently IIS gives you helpful error messages if it detects you haven't run through the migration yet.&#160; The two most common things that ASP.NET websites have that require this migration are if you have declared <font face="Courier New">httpModules</font> or <font face="Courier New">httpHandlers</font> in your <font face="Courier New">Web.config</font>.&#160; The fix is to either copy or move these sections under <font face="Courier New">system.web</font> to their corresponding <font face="Courier New">system.webServer</font> sections.&#160; If you duplicate the sections, then you should be able run under both <font face="Courier New">Integrated</font> and <font face="Courier New">Classic</font> modes without any problems.&#160; You can even still run on IIS 6 I believe, as IIS 6 will ignore this new section called <font face="Courier New">system.webServer</font> which is IIS 7 specific.&#160; IIS 7 even provides a utility that can perform this migration for you; here is the what you would type in a Command Prompt:</p>  <p><font face="Courier New">%windir%\system32\inetsrv\APPCMD.EXE migrate config &lt;Application Path&gt;</font></p>  <p>...where <font face="Courier New">&lt;Application Path&gt;</font> would be something like <font face="Courier New">&quot;Default Web Site/&quot;</font> or <font face="Courier New">&quot;Default Web Site/someApp&quot;</font>.&#160; If you manually migrate your <font face="Courier New">Web.config</font> and are still getting migration error messages, here is a snippet you can add right under the <font face="Courier New">system.webServer</font> node to disable the error message:</p>  <p><font face="Courier New">&lt;validation validateIntegratedModeConfiguration=&quot;false&quot; /&gt;</font></p>  <p>Also, I want to make note of something I couldn't get to work that they showed in the tutorial video.&#160; At about the <font face="Courier New">13:50</font> mark in the video, they go into the <font face="Courier New">Modules</font> section of the UI.&#160; These are the modules of the IIS pipeline for both managed .NET code and unmanaged code.&#160; In order to make their video file hidden behind ASP.NET Forms Authentication, they change a property on two authentication modules to allow these modules to execute on non-managed content as well.&#160; However, this did not work for me for some reason when I was trying to secure HTML pages behind Forms Authentication.&#160; What did work for me (and may have been a drastic solution) was to put the following attribute on the <font face="Courier New">modules</font> node under <font face="Courier New">system.webServer</font>:</p>  <p><font face="Courier New">&lt;modules runAllManagedModulesForAllRequests=&quot;true&quot; /&gt;</font></p>  <p>I believe the issue in my case was their was another few managed modules that I needed to clear that checkbox for in the UI.&#160; But I didn't take the time to find out which ones I was missing and opted for the drastic solution.&#160; I will also say there is a way to configure these managed modules through your <font face="Courier New">Web.config</font> so you don't have to have your IT Admin configure properties manually in the UI.&#160; In fact, it seems that much of IIS 7 configuration for your website can be done this way.</p>  <h3>A Few Error Messages (and Their Solutions)</h3>  <p>If you get error messages while using the IIS Manager user interface like this...</p>  <blockquote>   <p>&quot;This feature cannot be used because the default provider type could not be determined to check whether it is a trusted provider.</p>    <p>&quot;You can use this feature only when the default provider is a trusted provider.&#160; If you are a server administrator, you can make a provider a trusted provider by adding the provider type to the trusted providers list in the Administration.config file.&#160; The provider has to be strongly typed and added to the GAC (Global Assembly Cache).&quot;</p> </blockquote>  <p>...then you should visit the following article for detailed information about resolving the error message:</p>  <ul>   <li><a href="http://www.iis.net/ConfigReference/system.webServer/management/trustedProviders/add">Adding Management Trusted Providers &lt;add&gt;</a> </li> </ul>  <p>Getting rid of this error message is really only for convenience in letting the IIS Manager UI be able to query your database using your providers and give you a basic view of your Membership, Roles, and Profile fields.&#160; Also, if you are trying to find your <font face="Courier New">Administration.config</font> file, it is likely located under the <font face="Courier New">C:\Windows\System32\inetsrv\config\</font> folder.</p>  <p>The other error message I received was not in the IIS Manager UI, but rather when you attempt to view your website in a browser (after you think you got all the configuration bugs out!).&#160; A <font face="Courier New">BadImageFormatException</font> is thrown and the error details say something like this:</p>  <p><font face="Courier New">Could not load file or assembly 'AssemlyNameHere' or one of its dependencies.&#160; An attempt was made to load a program with an incorrect format.</font></p>  <p>The likely cause of this error is that the assembly referenced in the error message was compiled only for 32-bit machines and you are running a 64-bit operating system.&#160; With Windows Server 2008 x64, the application pools in IIS have an <font face="Courier New">Advanced Setting</font> called <font face="Courier New">Enable 32-Bit Applications</font>, that is disabled by default.&#160; Enable this setting and you're probably good to go.&#160; See the following link for more detailed information and some nice screenshots:</p>  <ul>   <li><a href="http://blog.crowe.co.nz/archive/2007/11/05/Could-not-load-file-or-assembly-name-or-one-of.aspx">Could not load file or assembly 'name' or one of its dependencies</a> </li> </ul>  <h3>Additional Reading</h3>  <p>I just barely noticed that <a href="http://www.4guysfromrolla.com/">4GuysFromRolla.com</a> recently posted an article about the exact same stuff I was attempting to explain.&#160; To read additional details about IIS 7's Integrated Pipeline and ASP.NET Forms Authentication with static content, check out the following link:</p>  <ul>   <li><a href="http://aspnet.4guysfromrolla.com/articles/122408-1.aspx">Apply ASP.NET Authentication and Authorization Rules to Static Content with IIS 7.0's Integrated Pipeline Feature</a> </li> </ul>  <h3>Conclusion</h3>  <p>I hope you've enjoyed <a title="ASP.NET Providers - Membership, Role, and Profile" href="http://murrayon.net/2009/01/aspnet-providers-membership-role-and.html">this series on the ASP.NET Provider System</a>.&#160; My desire is that you've found these posts helpful in getting you started with implementing such a versatile and customizable model for adding common membership and authorization functionality to your new and existing websites.&#160; There are quite a few advantages in hosting your site on IIS 7 in Windows Server 2008, as I've outlined in this specific post.&#160; Hopefully these discussions about errors and gotchas will also help you get going in no time!</p> </span>  </div>


<h2>Comments</h2>


<div class='comments'>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
Thanks. Awesome job.</div>
</div>
<div class='comment'>
<div class='author'>Tony</div>
<div class='content'>
Prefect article and thanks for the video links. It helped me understand this whole integrated vs classic iis7 mode and was a refresher on forms authenication.</div>
</div>
<div class='comment'>
<div class='author'>Radek</div>
<div class='content'>
Thanks. This post helped me resolved serious issue with IIS7</div>
</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ASP.NET Profile and Web Application Projects]]></title>
    <link href="http://mkmurray.com/blog/2009/02/11/asp-net-profile-and-web-application-projects/"/>
    <updated>2009-02-11T15:08:00-07:00</updated>
    <id>http://mkmurray.com/blog/2009/02/11/asp-net-profile-and-web-application-projects</id>
    <content type="html"><![CDATA[<div class='post'>
<p>I talked at length about the ASP.NET <a href="http://en.wikipedia.org/wiki/Provider_model">Provider Model pattern</a> and the ease of implementing several built-in services you can have for free with ASP.NET 2.0 in <a title="ASP.NET Providers - Membership, Role, and Profile" href="http://murrayon.net/2009/01/aspnet-providers-membership-role-and.html">my previous series of posts</a>.&#160; In this post, I will be discussing a few issues I ran into using the Profile system with the <font face="Courier New">Web Application</font> project template instead of the <font face="Courier New">Web Site</font> project template as found in Visual Studio's list of default project templates.</p>  <p>The crux of the issue is that Visual Studio doesn't automatically generate the <font face="Courier New">Profile</font> proxy class object when using the <font face="Courier New">Web Application</font> project template, like it does with the <font face="Courier New">Web Site</font> project template.&#160; This proxy class can be used to obtain access to strongly-typed properties representing the custom Profile fields you specified in your <font face="Courier New">Web.config</font>.&#160; This is a very convenient way to access a user's Profile data, both for authenticated and for anonymous users.</p>  <p>Let's discuss the issue a little further and then I will present a workaround that I found and have successfully implemented in my own project.</p> <span class='fullpost'> <h3>VS Project Templates:&#160; Web Site vs. Web Application</h3>  <p>It appears that Microsoft has tried to differentiate these two project templates as much as possible in Visual Studio 2008.&#160; In 2005, you would go to the <font face="Courier New">New Project</font> dialog window and you would see these two <font face="Courier New">Web</font> project templates side-by-side, wondering what difference it would make if you chose one over the other.&#160; However, in Visual Studio 2008, it appears they reworked this whole dialog and menu system for starting a new project so that you would never see these two project templates side-by-side.&#160; In 2008, you have more than one option in the <font face="Courier New">File</font> menu for starting a project; those options are <font face="Courier New">File | New | Project</font> and <font face="Courier New">File | New | Web Site</font>.&#160; The first option is the one that will get you to the <font face="Courier New">ASP.NET Web Application</font> template, while the second takes you to the <font face="Courier New">ASP.NET Web Site</font> project template.</p>  <p>Now as for the differences between these two templates, I'll outline a few of the main differences and give a little bit of history of how these two templates came to coexist.&#160; The history in a nutshell is that Visual Studio 2005 came out with the <font face="Courier New">Web Site</font> project template to replace the old, but proven project configuration used by ASP.NET 1.x.&#160; In the opinion of many, the old template better encouraged Object-Oriented design practices.&#160; The new template had no project file for explicitly delineating what files where included in the project and namespacing was quite cumbersome, as the only painless design was to let everything pile up into one big default namespace.&#160; A few other changes involved taking ASP.NET back to compiling on the fly at the web server and also drastically changing the organization of UI template and code-behind files.&#160; It appears the intention was to closely mimic the configuration and deployment practices of popular agile languages like PHP and Ruby on Rails.</p>  <p>In the Service Pack 1 of Visual Studio 2005, Microsoft decided to resurrect the older project template under the name of <font face="Courier New">Web Application</font>.&#160; There is evidence to suggest that Microsoft considers this latter project template an &quot;enterprise&quot; project type, as compared to the casual <font face="Courier New">Web Site</font> project template.&#160; With the advent of Visual Studio 2008, it is apparent that Microsoft is committed to supporting both project types for at least a little while.&#160; For a more detailed discussion of the history and differences of these two project templates, I suggest the following blog post by <a href="http://reddnet.net/code/">Stephen M. Redd</a>:</p>  <ul>   <li><a href="http://reddnet.net/code/aspnet-web-site-vs-web-application/">ASP.NET - Web Site vs. Web Application</a></li> </ul>  <h3>Web Profile Builder by Joe Wrobel</h3>  <p>The ability to retrieve and update your custom Profile fields at design time via strongly-typed properties on the <font face="Courier New">Profile</font> proxy class is extremely convenient.&#160; Unfortunately, you get no such compiler and intellisense love if you are using the <font face="Courier New">Web Application</font> project template for your site.</p>  <p>In trying to find a workaround, I came across a <a title="Web Profile Builder for Web Application Projects" href="http://weblogs.asp.net/joewrobel/archive/2008/02/03/web-profile-builder-for-web-application-projects.aspx">blog post by Joe Wrobel introducing a project he worked on to solve this issue</a>.&#160; It's called the <font face="Courier New">Web Profile Builder</font> (here's a <a title="Web Profile Builder" href="http://code.msdn.microsoft.com/WebProfileBuilder/Release/ProjectReleases.aspx">link to it's project page on MSDN Code Gallery</a>) and it was based on a project called the <a href="http://www.codeplex.com/WebProfile">Web Profile Generator</a>, which was a Visual Studio 2005 Add-In project found on <a href="http://www.codeplex.com/">CodePlex</a>.&#160; The latter project seems to have not been worked on in over a year and a half, nor does it seem to be compatible with Visual Studio 2008.&#160; Hence, Joe feeling the need to start up on his own project, with a few improvements on the side of course.</p>  <p>In Joe's introductory post to the project, he mentions he changed the Visual Studio integration from being a plug-in to being an MSBuild Build Task.&#160; The method for incorporating the Build Task into your project is to add a line into your project file (the one with file extension <font face="Courier New">.csproj</font>).&#160; In case you weren't aware, Visual Studio project files are just <a href="http://en.wikipedia.org/wiki/MSBuild">MSBuild</a> build scripts.&#160; For details about where to put this line in the file (and about a message Visual Studio pops up when it detects you've mucked with the project file), be sure to check out <a title="Web Profile Builder for Web Application Projects" href="http://weblogs.asp.net/joewrobel/archive/2008/02/03/web-profile-builder-for-web-application-projects.aspx">Joe's post on the Web Profile Builder project</a>.</p>  <p>There are a couple of other things I need to point out about using the Build Task that weren't entirely clear to me beforehand.&#160; The build task actually generates a C# code file that is intended to be included into your project; once it's generated, you need to go to the <font face="Courier New">Solution Explorer</font> and explicitly add it as a file in your project (one way is through the <font face="Courier New">Add | Existing Item</font> menu option).&#160; One of the main things that helped me decide to use this solution and how to configure it was reading two blog posts from <a href="http://www.codersbarn.com/">Anthony Grace</a>; the second post below has a great excerpt apparently from the <font face="Courier New">Web Profile Builder</font> documentation that explains the process I outlined above in a bit more detail:</p>  <ul>   <li><a href="http://www.codersbarn.com/post/2008/06/ASPNET-Web-Site-versus-Web-Application-Project.aspx">ASP.NET: Web Site versus Web Application Project</a></li>    <li><a href="http://www.codersbarn.com/post/2008/07/10/ASPNET-PayPal-Subscriptions-IPN.aspx">ASP.NET PayPal Subscription IPN</a></li> </ul>  <p>Also, it is not necessary to do the steps in the <font face="Courier New">Extended Usage</font> section of Joe's blog post.&#160; They are optional configuration points in the <font face="Courier New">Web.config</font> where you control the <font face="Courier New">className</font>, <font face="Courier New">nameSpace</font>, <font face="Courier New">directory</font>, and <font face="Courier New">fileName</font> of the auto-generated code file.&#160; Most of the defaults are fine, but in my case I wanted the generated file to end up in an <font face="Courier New">App_Code</font> directory instead of in the root of the project folder.&#160; If you decide to add in this custom configuration, you need to be aware that you must add the following XML namespace to the <font face="Courier New">configuration</font> root element of your <font face="Courier New">Web.config</font>:</p>  <p><font face="Courier New">xmlns=&quot;http://schemas.microsoft.com/.NetConfiguration/v2.0&quot;</font></p>  <p>Finally, it should be noted that if the website you are building is under source control, you will likely want to always keep this auto-generated code file checked out in order to prevent the file from having its <font face="Courier New">Read-Only</font> attribute set when it's checked in.&#160; If you don't have it checked out, the build will throw out a warning and the generated code file will not be regenerated if changes in your <font face="Courier New">Web.config</font> need to be propagated to it.</p>  <h3>Conclusion</h3>  <p>With all of this in place, you should be able to use the Profile proxy class object in your ASPX code-behind files, just as I gave examples of in my <a href="http://murrayon.net/2009/02/aspnet-providers-profile.html">previous post about the ASP.NET Profile system</a>.&#160; Although in my case, I mostly used the static method <font face="Courier New">GetProfile</font> from the auto-generated <font face="Courier New">WebProfile</font><font face="Verdana"> class (the name the Visual Studio Build Task selects by default).</font></p>  <p>As I mentioned when <a title="ASP.NET Providers - Membership, Role, and Profile" href="http://murrayon.net/2009/01/aspnet-providers-membership-role-and.html">I first started the ASP.NET Provider Series of posts</a>, my next blog post will be about some advantages of using this Provider system on IIS 7 and a few issues when your ASP.NET website contains non-ASP.NET content:</p>  <ul>   <li><a href="http://murrayon.net/2009/02/iis-7-and-aspnet-providers-membership.html">IIS 7 and ASP.NET Providers (Membership, Roles, and Profile)</a> </li> </ul> </span>  </div>


<h2>Comments</h2>


<div class='comments'>
<div class='comment'>
<div class='author'>Martena Gaines</div>
<div class='content'>
Web sites are dynamically compiled and source is distributed with them. Web Applications can be compiled into a single DLL and deployed. You cannot use the app_code folder in WAP projects, but you can with WSP.</div>
</div>
</div>

]]></content>
  </entry>
  
</feed>
